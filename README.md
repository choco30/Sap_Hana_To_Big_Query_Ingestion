# Sap Hana TO Big Query
## About
This Project is about fetching Data from Sap Hana Cloud To Big Query Using Apache Beam using Gcp serverless Etl solution i.e. Dataflow as a back end engine to extract the data from the source. We are orchestrating the entire workflow using GCP Composer which is the managed version of Apache Airflow. We are Also Using GCP Secret Manger to Store And Fetch the Sap Hana Credentials At Run Time.  
## Toolbox ðŸ§°
<img src="https://www.yash.com/wp-content/uploads/2017/12/sap_hana_cloud.png" width="50" height="50" alt="SAP HANA"/> &emsp; <img src="https://lh6.googleusercontent.com/1MICxjbrbRPtEnzE54g2shaMRD2RocCIcuSOrqwaqryObCR6IrsXNb3Sd5MjBBwmoLeVcgVu_SE3vw-IbRA24SFhH4IT1xppVuuNGodDtFEykgD0Cw1vB2jITTsOgBNHvWfw27icmMs30SYgWQ" width="70" alt="GCP DTAFLOW" height="70"/>
&emsp; <img src="data:image/png;base64,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" width ="90" height="75" alt="Apache Kafka"/>
&emsp;<img src ="https://raw.githubusercontent.com/devicons/devicon/1119b9f84c0290e0f0b38982099a2bd027a48bf1/icons/mongodb/mongodb-original-wordmark.svg" width="70" height="70" alt="Mongo Db"/>

## Installation Steps
1.First we need to install Python(3.7) and java(jdk 8) On the machine for this projet to work appropiately.<br>
2.After the successfull installation of above we need to download and <a href="https://kafka.apache.org/">Install Kafka</a> version 2.6.0 with scala version 2.12.<br>
3.Now we Need to Download Apache Spark <a href ="https://spark.apache.org/downloads.html">Apache Spark </a>version 3.3.0 with hadoop version 3.3. Download the <a href="https://github.com/cdarlint/winutils">winUtils file</a> for hadoop version 3.<br>
4.Now we need to setup the path in enviornment variables for spark and haddop.<br>
5.Login to your mongo db atlas cluster and get the connection string to coonect to the database.<br>

## Deployment Process
### starting up zookeeper server on local host 9092
.\bin\windows\zookeeper-server-start.bat .\config\zookeeper.properties
### starting up kafka broker
.\bin\windows\kafka-server-start.bat .\config\server.properties
### Creating kafka topic 
.\bin\windows\kafka-topics.bat --create --topic <topic_name> --replication-factor 1 --partitions 1<br><br>
Now you kafka Broker is up , you need to deploy the above code in any on the IDE of your choice and you will start seeing the data in your mongodb cluster 

## Note
1.Since the kafka and mongo db connector are not part of the default spark package you need to define the connectors as the configuration while creating the spark session as mentioned in the code.<br>

2.While working with any IDE you need to import the spark and hadoop enviornment variable in the project structure under settings.
